<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Songs - Song List Manager</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-brand">
                <span class="brand-icon">ðŸŽµ</span>
                <span data-en="Song List Manager" data-ja="æ›²åˆ—è¡¨ç®¡ç†">Song List Manager</span>
            </a>
            <ul class="nav-menu">
                <li><a href="import.html"><i class="fas fa-file-import"></i> <span class="nav-text" data-en="Import" data-ja="ã‚¤ãƒ³ãƒãƒ¼ãƒˆ">Import</span></a></li>
                <li><a href="allsongs.html" class="active"><i class="fas fa-music"></i> <span class="nav-text" data-en="All Songs" data-ja="å…¨æ›²">All Songs</span></a></li>
                <li><a href="songs-by-date.html"><i class="fas fa-calendar-alt"></i> <span class="nav-text" data-en="By Date" data-ja="æ—¥ä»˜é †">By Date</span></a></li>
                <li><a href="random-pick.html"><i class="fas fa-dice"></i> <span class="nav-text" data-en="Random Pick" data-ja="ãƒ©ãƒ³ãƒ€ãƒ ãƒ”ãƒƒã‚¯">Random Pick</span></a></li>
                <li><a href="stream.html"><i class="fas fa-play-circle"></i> <span class="nav-text" data-en="Live Stream" data-ja="ãƒ©ã‚¤ãƒ–é…ä¿¡">Live Stream</span></a></li>
                <li><a href="settings.html"><i class="fas fa-cog"></i> <span class="nav-text" data-en="Settings" data-ja="è¨­å®š">Settings</span></a></li>
                <li><a href="#" class="lang-toggle" onclick="toggleLanguage(); return false;"><i class="fas fa-language"></i> <span class="nav-text" id="langLabel">EN</span></a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="page-header">
            <h1><span class="header-icon">ðŸŽµ</span> <span data-en="All Songs" data-ja="å…¨æ›²">All Songs</span></h1>
            <div class="btn-group">
                <button class="btn" onclick="clearAllData() && location.reload()">
                    <i class="fas fa-trash"></i> <span data-en="Clear All" data-ja="å…¨ã¦å‰Šé™¤">Clear All</span>
                </button>
            </div>
        </div>

        <!-- Actions Bar -->
        <div class="actions-bar">
            <input type="text" class="filter-input" id="filterInput" data-en-placeholder="Filter by song name, singer, or date..." data-ja-placeholder="æ›²åã€æ­Œæ‰‹ã€æ—¥ä»˜ã§æ¤œç´¢..." placeholder="Filter by song name, singer, or date..." oninput="renderAllSongs()">
            
            <button class="sort-btn active" onclick="setSort('dateDesc')">
                <i class="fas fa-sort-numeric-down"></i> <span data-en="Newest First" data-ja="æ–°ã—ã„é †">Newest First</span>
            </button>
            <button class="sort-btn" onclick="setSort('dateAsc')">
                <i class="fas fa-sort-numeric-up"></i> <span data-en="Oldest First" data-ja="å¤ã„é †">Oldest First</span>
            </button>
            <button class="sort-btn" onclick="setSort('nameAsc')">
                <i class="fas fa-sort-alpha-down"></i> <span data-en="A-Z" data-ja="ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †">A-Z</span>
            </button>
        </div>

        <!-- All Songs List -->
        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-list-ul"></i> <span data-en="All Song Entries" data-ja="å…¨æ›²ãƒªã‚¹ãƒˆ">All Song Entries</span></h2>
                <span class="date-badge">
                    <i class="fas fa-music"></i> <span id="totalEntries">0</span> <span data-en="entries" data-ja="ä»¶">entries</span>
                </span>
            </div>
            <div class="list-container" id="allSongsList">
                <div class="empty-state">
                    <i class="fas fa-music"></i>
                    <p>No songs imported yet</p>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        let currentSort = 'dateDesc';

        document.addEventListener('DOMContentLoaded', function() {
            renderAllSongs();
        });

        function setSort(sortType) {
            currentSort = sortType;
            document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            renderAllSongs();
        }

        function renderAllSongs() {
            const songs = Object.values(getSongData());
            const filter = document.getElementById('filterInput').value.toLowerCase();
            const container = document.getElementById('allSongsList');

            document.getElementById('totalEntries').textContent = songs.length;

            // Filter - show grouped songs (no duplicates)
            let filteredSongs = songs.filter(song => {
                const nameMatch = (song.name || '').toLowerCase().includes(filter);
                const singerMatch = (song.singer || '').toLowerCase().includes(filter);
                return nameMatch || singerMatch;
            });

            // Sort
            filteredSongs.sort((a, b) => {
                switch(currentSort) {
                    case 'countDesc':
                        return b.count - a.count;
                    case 'countAsc':
                        return a.count - b.count;
                    case 'nameAsc':
                        return (a.name || '').localeCompare(b.name || '');
                    default:
                        return 0;
                }
            });

            if (filteredSongs.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-music"></i>
                        <p>${songs.length === 0 ? 'No songs imported yet' : 'No matching songs found'}</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredSongs.map(song => `
                <div class="list-item">
                    <div class="list-item-icon">
                        <span class="item-emoji">ðŸŽµ</span>
                    </div>
                    <div class="list-item-info">
                        <div class="list-item-name">${song.name}</div>
                        <div class="list-item-meta">
                            <span><i class="fas fa-microphone"></i> ${song.singer || 'Unknown'}</span>
                            ${song.duration ? `<span><i class="fas fa-clock"></i> ${song.duration}</span>` : ''}
                        </div>
                    </div>
                    <div class="list-item-count">${song.count}</div>
                </div>
            `).join('');
        }
    </script>
</body>
</html>
