<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Song List Manager</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-brand">
                <span class="brand-icon">ğŸµ</span>
                <span data-en="Song List Manager" data-ja="æ›²åˆ—è¡¨ç®¡ç†">Song List Manager</span>
            </a>
            <ul class="nav-menu">
                <li><a href="import.html"><i class="fas fa-file-import"></i> <span class="nav-text" data-en="Import" data-ja="ã‚¤ãƒ³ãƒãƒ¼ãƒˆ">Import</span></a></li>
                <li><a href="allsongs.html"><i class="fas fa-music"></i> <span class="nav-text" data-en="All Songs" data-ja="å…¨æ›²">All Songs</span></a></li>
                <li><a href="songs-by-date.html"><i class="fas fa-calendar-alt"></i> <span class="nav-text" data-en="By Date" data-ja="æ—¥ä»˜é †">By Date</span></a></li>
                <li><a href="random-pick.html"><i class="fas fa-dice"></i> <span class="nav-text" data-en="Random Pick" data-ja="ãƒ©ãƒ³ãƒ€ãƒ ãƒ”ãƒƒã‚¯">Random Pick</span></a></li>
                <li><a href="stream.html"><i class="fas fa-play-circle"></i> <span class="nav-text" data-en="Live Stream" data-ja="ãƒ©ã‚¤ãƒ–é…ä¿¡">Live Stream</span></a></li>
                <li><a href="settings.html"><i class="fas fa-cog"></i> <span class="nav-text" data-en="Settings" data-ja="è¨­å®š">Settings</span></a></li>
                <li><a href="#" class="lang-toggle" onclick="toggleLanguage(); return false;"><i class="fas fa-language"></i> <span class="nav-text" id="langLabel">EN</span></a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="page-header">
            <h1><span class="header-icon">ğŸ“Š</span> <span data-en="Dashboard" data-ja="ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰">Dashboard</span></h1>
            <div class="btn-group">
                <button class="btn btn-export" onclick="exportToXLSX()">
                    <span class="btn-icon">ğŸ“¥</span> <span data-en="Export XLSX" data-ja="XLSXã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ">Export XLSX</span>
                </button>
                <button class="btn btn-export" onclick="exportToCSV()">
                    <span class="btn-icon">ğŸ“‹</span> <span data-en="Export CSV" data-ja="CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ">Export CSV</span>
                </button>
            </div>
        </div>

        <!-- Main Stats -->
        <div class="dashboard-grid">
            <div class="stat-card stat-card-blue">
                <div class="stat-header-row">
                    <div class="stat-icon-wrap">
                        <span class="stat-emoji">ğŸ¤</span>
                    </div>
                    <div class="stat-number-wrap">
                        <div class="number" id="uniqueSongs">0</div>
                    </div>
                </div>
                <div class="stat-content">
                    <div class="label">
                        <span class="label-icon">ğŸµ</span> <span data-en="Unique Song & Singer Groups" data-ja="ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªæ›²ã¨æ­Œæ‰‹ã‚°ãƒ«ãƒ¼ãƒ—">Unique Song & Singer Groups</span>
                    </div>
                </div>
                <div class="stat-bar">
                    <div class="stat-bar-fill" style="width: 0%"></div>
                </div>
            </div>
            <div class="stat-card stat-card-purple">
                <div class="stat-header-row">
                    <div class="stat-icon-wrap">
                        <span class="stat-emoji">â–¶ï¸</span>
                    </div>
                    <div class="stat-number-wrap">
                        <div class="number" id="totalPlays">0</div>
                    </div>
                </div>
                <div class="stat-content">
                    <div class="label">
                        <span class="label-icon">ğŸ”¥</span> <span data-en="Total Song Entries" data-ja="ç·æ›²æ•°">Total Song Entries</span>
                    </div>
                </div>
                <div class="stat-bar">
                    <div class="stat-bar-fill" style="width: 0%"></div>
                </div>
            </div>
            <div class="stat-card stat-card-green">
                <div class="stat-header-row">
                    <div class="stat-icon-wrap">
                        <span class="stat-emoji">â­</span>
                    </div>
                    <div class="stat-number-wrap">
                        <div class="number" id="uniqueSingers">0</div>
                    </div>
                </div>
                <div class="stat-content">
                    <div class="label">
                        <span class="label-icon">ğŸ‘¤</span> <span data-en="Unique Singers" data-ja="ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªæ­Œæ‰‹æ•°">Unique Singers</span>
                    </div>
                </div>
                <div class="stat-bar">
                    <div class="stat-bar-fill" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="charts-grid">
            <!-- Top Songs -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3><span class="chart-icon">ğŸ¥‡</span> <span data-en="Top 10 Most Played Songs" data-ja="å†ç”Ÿå›æ•°ãƒˆãƒƒãƒ—10">Top 10 Most Played Songs</span></h3>
                    <div class="chart-badge">ğŸ”¥ <span data-en="Hot" data-ja="äººæ°—">Hot</span></div>
                </div>
                <div class="top-songs-list" id="topSongsList">
                    <div class="empty-state">
                        <span class="empty-emoji">ğŸ¶</span>
                        <p>No data yet</p>
                        <span class="empty-subtext">Import songs to see statistics</span>
                    </div>
                </div>
            </div>

            <!-- Top Singers -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3><span class="chart-icon">ğŸ¤</span> <span data-en="Top Singers" data-ja="æ­Œæ‰‹ãƒ©ãƒ³ã‚­ãƒ³ã‚°">Top Singers</span></h3>
                    <div class="chart-badge chart-badge-purple">âœ¨ <span data-en="Stars" data-ja="ã‚¹ã‚¿ãƒ¼">Stars</span></div>
                </div>
                <div class="top-songs-list" id="topSingersList">
                    <div class="empty-state">
                        <span class="empty-emoji">ğŸ¤</span>
                        <p>No data yet</p>
                        <span class="empty-subtext">Import songs to see statistics</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="card">
            <div class="card-header">
                <h2><span class="card-icon">ğŸ•</span> <span data-en="Recently Added" data-ja="æœ€è¿‘è¿½åŠ ">Recently Added</span></h2>
                <div class="card-actions">
                    <span class="live-badge"><span class="live-dot"></span> Live</span>
                </div>
            </div>
            <div class="list-container" id="recentActivity">
                <div class="empty-state">
                    <span class="empty-emoji">ğŸ“</span>
                    <p>No recent activity</p>
                    <span class="empty-subtext">Your song history will appear here</span>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            loadDashboard();
        });

        function loadDashboard() {
            const stats = getStats();
            
            // Update main stats with animation
            animateNumber('uniqueSongs', stats.uniqueSongs);
            animateNumber('totalPlays', stats.totalPlays);
            animateNumber('uniqueSingers', stats.uniqueSingers);

            // Top Songs
            const topSongsList = document.getElementById('topSongsList');
            if (stats.topSongs.length > 0) {
                topSongsList.innerHTML = stats.topSongs.map((song, index) => {
                    const rankClass = index === 0 ? 'rank-gold' : index === 1 ? 'rank-silver' : index === 2 ? 'rank-bronze' : 'rank-default';
                    const rankEmoji = index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : index === 2 ? 'ğŸ¥‰' : `${index + 1}`;
                    return `
                        <div class="top-song-item ${rankClass}">
                            <div class="top-song-rank">${rankEmoji}</div>
                            <div class="top-song-info">
                                <div class="top-song-name">${song.name}</div>
                                <div class="top-song-singer"><span class="singer-icon">ğŸ¤</span> ${song.singer || 'Unknown'}</div>
                            </div>
                            <div class="top-song-plays">
                                <span class="plays-count">${song.count}</span>
                                <span class="plays-label">plays</span>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            // Top Singers
            const topSingersList = document.getElementById('topSingersList');
            if (stats.topSingers.length > 0) {
                topSingersList.innerHTML = stats.topSingers.map((singer, index) => {
                    const rankClass = index === 0 ? 'rank-gold' : index === 1 ? 'rank-silver' : index === 2 ? 'rank-bronze' : 'rank-default';
                    const rankEmoji = index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : index === 2 ? 'ğŸ¥‰' : `${index + 1}`;
                    return `
                        <div class="top-song-item ${rankClass}">
                            <div class="top-song-rank">${rankEmoji}</div>
                            <div class="top-song-info">
                                <div class="top-song-name singer-name">
                                    <span class="singer-avatar">${getAvatarEmoji(singer[0])}</span>
                                    ${singer[0]}
                                </div>
                            </div>
                            <div class="top-song-plays">
                                <span class="plays-count">${singer[1]}</span>
                                <span class="plays-label">songs</span>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            // Recent Activity
            const songs = Object.values(getSongData());
            const allEntries = songs.flatMap(s => s.entries || []).sort((a, b) => {
                return new Date(b.addedDate) - new Date(a.addedDate);
            }).slice(0, 10);

            const recentActivity = document.getElementById('recentActivity');
            if (allEntries.length > 0) {
                recentActivity.innerHTML = allEntries.map((entry, index) => `
                    <div class="list-item" style="animation-delay: ${index * 0.05}s">
                        <div class="list-item-icon">
                            <span class="item-emoji">ğŸµ</span>
                        </div>
                        <div class="list-item-info">
                            <div class="list-item-name">${entry.name}</div>
                            <div class="list-item-meta">
                                <span class="meta-item"><span class="meta-icon">ğŸ¤</span> ${entry.singer || 'Unknown'}</span>
                                <span class="meta-item"><span class="meta-icon">ğŸ“…</span> ${entry.date || 'No date'}</span>
                                <span class="meta-item"><span class="meta-icon">â°</span> ${entry.addedDate || 'Unknown'}</span>
                            </div>
                        </div>
                        <div class="list-item-badge">New</div>
                    </div>
                `).join('');
            }
        }

        function animateNumber(elementId, target) {
            const element = document.getElementById(elementId);
            const duration = 1000;
            const start = 0;
            const startTime = performance.now();
            
            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const easeOut = 1 - Math.pow(1 - progress, 3);
                const current = Math.floor(start + (target - start) * easeOut);
                element.textContent = current;
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }
            requestAnimationFrame(update);
        }

        function getAvatarEmoji(name) {
            const avatars = ['ğŸ¤', 'ğŸ§', 'ğŸµ', 'ğŸ¶', 'ğŸ¼', 'ğŸ¹', 'ğŸ¸', 'ğŸ·', 'ğŸº', 'ğŸ»'];
            let hash = 0;
            for (let i = 0; i < name.length; i++) {
                hash = name.charCodeAt(i) + ((hash << 5) - hash);
            }
            return avatars[Math.abs(hash) % avatars.length];
        }
    </script>
</body>
</html>
